<%- include('../partials/header', { title: title || 'Manajemen Domain' }) %>

<style>
    .action-form { display: flex; align-items: center; gap: 10px; }
    .form-control-sm { padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
    .btn-sm { padding: 8px 12px; font-size: 0.9rem; }
    .btn-danger { background-color: #ef4444; color: white; }
    .btn-primary { background-color: #3b82f6; color: white; }
</style>

<h1>Manajemen Domain</h1>
<p>Daftar semua domain yang terdaftar melalui sistem Anda. Anda dapat melakukan tindakan seperti men-suspend domain dari sini.</p>

<div class="card">
    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Nama Domain</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">ID Pelanggan</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Status</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Aksi</th>
                </tr>
            </thead>
<!-- ... di dalam views/admin/domains.ejs ... -->
<tbody>
    <% if (domains && domains.length > 0) { %>
        <% domains.forEach(domain => { %>
            <% const status = (domain.status_desc || '').toLowerCase(); %>
            <tr>
                <td style="padding: 12px; border-bottom: 1px solid #eee; font-weight: 500;"><%= domain.name || 'N/A' %></td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;"><%= domain.customer_id || 'N/A' %></td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;"><%= domain.status_desc || 'Tidak Diketahui' %></td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                    <%# HANYA TAMPILKAN TOMBOL YANG SESUAI DENGAN STATUS %>
                    <% if (status === 'active') { %>
                        <form action="/admin/domains/<%= domain.id %>/suspend" method="POST" class="action-form" onsubmit="return confirm('Yakin ingin men-suspend domain ini?');">
                            <input type="text" name="reason" placeholder="Alasan Suspend" class="form-control-sm" required>
                            <button type="submit" class="btn btn-danger btn-sm">Suspend</button>
                        </form>
                    <% } else if (status === 'suspended') { %>
                        <form action="/admin/domains/<%= domain.id %>/unsuspend" method="POST" onsubmit="return confirm('Yakin ingin mengaktifkan kembali domain ini?');">
                            <button type="submit" class="btn btn-primary btn-sm">Unsuspend</button>
                        </form>
                    <% } else { %>
                        <span style="color: #888;">(Tidak ada aksi)</span>
                    <% } %>
                </td>
            </tr>
        <% }) %>
    <% } else { %>
        <tr>
            <td colspan="4" style="padding: 20px; text-align: center;">Tidak ada domain yang ditemukan.</td>
        </tr>
    <% } %>
</tbody>
        </table>
    </div>
</div>

<%- include('../partials/footer') %>