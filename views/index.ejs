<%- include('partials/header') %>
<main>
    <section class="hero-section">
        <div class="container">
            <h1>Semua yang Anda Butuhkan untuk Sukses Online</h1>
            <p>Mulai dari domain, hosting, hingga alat canggih untuk mengembangkan bisnis Anda.</p>
            <a href="#pricing" class="btn btn-primary">Lihat Paket Sekarang</a>
        </div>
    </section>
    <section id="domain-search" class="domain-search-section">
        <div class="container">
            <h2>Wujudkan Ide Anda dengan Domain Sempurna</h2>
            <form id="domain-search-form">
                <input type="text" id="domain-input" placeholder="contoh: wanzofc.site" required>
                <button type="submit" id="domain-search-button"><i class="fas fa-search"></i> Cari</button>
            </form>
            <div id="domain-results"></div>
        </div>
    </section>
    <section id="pricing" class="pricing-section">
        <div class="container">
            <h2>Pilih Paket Terbaik Anda</h2>
            <div class="pricing-slider-container">
                <div class="pricing-grid" id="pricing-grid">
                    <% if (products && products.length > 0) { %>
                        <% products.forEach(product => { %>
                            <div class="pricing-card">
                                <div style="font-size: 3rem; text-align: center; color: var(--nexus-secondary); margin-bottom: 1rem;"><i class="<%= product.icon %>"></i></div>
                                <h3><%= product.name %></h3>
                                <p><%= product.description %></p>
                                <div><sup>Rp</sup><%= product.price.toLocaleString('id-ID') %><span><%= product.price_unit %></span></div>
                                <ul style="margin-top: 1rem;">
                                    <% product.features.forEach(feature => { %>
                                        <li><i class="fas fa-check-circle" style="color: var(--nexus-success);"></i> <%= feature %></li>
                                    <% }) %>
                                </ul>
                                <form action="/add-to-cart" method="POST" style="margin-top: auto;">
                                    <input type="hidden" name="type" value="product">
                                    <input type="hidden" name="plan" value="<%= product.name %>">
                                    <input type="hidden" name="price" value="<%= product.price %>">
                                    <button type="submit" class="btn btn-primary" style="width: 100%;">Pilih <%= product.name %></button>
                                </form>
                            </div>
                        <% }) %>
                    <% } %>
                </div>
            </div>
        </div>
    </section>
</main>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const domainForm = document.getElementById('domain-search-form');
        const domainInput = document.getElementById('domain-input');
        const domainResults = document.getElementById('domain-results');
        
        domainForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyword = domainInput.value.trim();
            if (!keyword) return;
            domainResults.innerHTML = '<div class="spinner"></div>';
            try {
                const response = await fetch('/check-domain', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ keyword }) });
                const results = await response.json();
                let resultsHTML = '<ul style="list-style:none; padding:0;">';
                results.forEach(result => {
                    let statusHTML = '';
                    if (result.status === 'available') {
                        // THIS IS THE FIX
                        statusHTML = `<div><span class="status-available">TERSEDIA</span> <a href="/order-domain?domain=${result.name}" class="btn btn-secondary btn-sm">Daftar</a></div>`;
                    } else if (result.status === 'taken') {
                        statusHTML = `<span class="status-taken">Sudah Diambil</span>`;
                    } else {
                        statusHTML = `<span class="status-taken">Gagal memeriksa</span>`;
                    }
                    resultsHTML += `<li class="suggestion-item"><span>${result.name}</span> ${statusHTML}</li>`;
                });
                resultsHTML += '</ul>';
                domainResults.innerHTML = resultsHTML;
            } catch (error) {
                domainResults.innerHTML = `<div style="text-align: center; color: #ef4444;">Terjadi kesalahan koneksi.</div>`;
            }
        });
    });
</script>
<%- include('partials/footer') %>