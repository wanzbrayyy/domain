</div>
    
    <% if (user) { %>
    <nav class="bottom-nav">
        <a href="/dashboard" class="bottom-nav-item"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
        <a href="/dashboard/buy-domain" class="bottom-nav-item"><i class="fas fa-search-dollar"></i><span>Beli Domain</span></a>
        <a href="/dashboard/transfer-domain" class="bottom-nav-item"><i class="fas fa-exchange-alt"></i><span>Transfer</span></a>
        <a href="/dashboard/settings" class="bottom-nav-item"><i class="fas fa-user-cog"></i><span>Akun</span></a>
        <% if (user.role === 'admin') { %>
            <a href="/admin" class="bottom-nav-item"><i class="fas fa-shield-alt"></i><span>Admin</span></a>
        <% } %>
    </nav>
    <% } %>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- GLOBAL NAVIGATION SCRIPTS ---
        const publicNavToggle = document.getElementById('public-nav-toggle');
        const publicNavMenu = document.getElementById('public-nav-menu');
        if (publicNavToggle) {
            publicNavToggle.addEventListener('click', () => {
                publicNavMenu.classList.toggle('show');
            });
        }
        
        const profileAvatar = document.getElementById('profile-avatar-container');
        const profileDropdown = document.getElementById('profile-dropdown');
        if (profileAvatar) {
            profileAvatar.addEventListener('click', (event) => {
                event.stopPropagation();
                profileDropdown.classList.toggle('show');
            });
        }
        document.addEventListener('click', (event) => {
            if (profileDropdown && !profileDropdown.contains(event.target) && !profileAvatar.contains(event.target)) {
                profileDropdown.classList.remove('show');
            }
        });

        // --- AVATAR GENERATION SCRIPT ---
        function generateAvatar(name) {
            if (!name) return '';
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const size = 64; 
            canvas.width = size; canvas.height = size;
            
            const nameParts = name.trim().split(' ');
            const initials = nameParts.length > 1 
                ? `${nameParts[0][0]}${nameParts[nameParts.length - 1][0]}`
                : nameParts[0][0];

            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                hash = name.charCodeAt(i) + ((hash << 5) - hash);
            }
            context.fillStyle = `hsl(${hash % 360}, 40%, 50%)`;
            context.fillRect(0, 0, size, size);
            
            context.fillStyle = '#ffffff';
            context.font = `bold ${size / 2.5}px Poppins`;
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            context.fillText(initials.toUpperCase(), size / 2, size / 2);
            
            return canvas.toDataURL();
        }

        document.querySelectorAll('.default-avatar-img').forEach(img => {
            const src = img.getAttribute('src');
            // Check for empty, null, or 'undefined' string
            if (!src || src === 'undefined') {
                const name = img.getAttribute('data-name');
                if (name) img.src = generateAvatar(name);
            }
        });
    });
    </script>
</body>
</html>